(function(){
var j=null;function n(){return function(){}}
window.JSON&&window.JSON.stringify||function(){function a(a){b.lastIndex=0;return b.test(a)?'"'+a.replace(b,function(a){var c=m[a];return"string"===typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(b,E){var k,g,d,s,p=e,h,i=E[b];i&&("object"===typeof i&&"function"===typeof i.toJSON)&&(i=i.toJSON(b));"function"===typeof l&&(i=l.call(E,b,i));switch(typeof i){case "string":return a(i);case "number":return isFinite(i)?String(i):"null";case "boolean":case "null":return String(i);
case "object":if(!i)return"null";e+=f;h=[];if("[object Array]"===Object.prototype.toString.apply(i)){s=i.length;for(k=0;k<s;k+=1)h[k]=c(k,i)||"null";d=0===h.length?"[]":e?"[\n"+e+h.join(",\n"+e)+"\n"+p+"]":"["+h.join(",")+"]";e=p;return d}if(l&&"object"===typeof l){s=l.length;for(k=0;k<s;k+=1)g=l[k],"string"===typeof g&&(d=c(g,i))&&h.push(a(g)+(e?": ":":")+d)}else for(g in i)Object.hasOwnProperty.call(i,g)&&(d=c(g,i))&&h.push(a(g)+(e?": ":":")+d);d=0===h.length?"{}":e?"{\n"+e+h.join(",\n"+e)+"\n"+
p+"}":"{"+h.join(",")+"}";e=p;return d}}window.JSON||(window.JSON={});"function"!==typeof String.prototype.toJSON&&(String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,f,m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,
b,k){var g;f=e="";if("number"===typeof k)for(g=0;g<k;g+=1)f+=" ";else"string"===typeof k&&(f=k);if((l=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return c("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
if(!window.PUBNUB){var r=function(){return"x"+ ++aa+""+ +new Date},t=function(){return+new Date},ba=function(a,c){function b(){f+c>t()?(clearTimeout(e),e=setTimeout(b,c)):(f=t(),a())}var e,f=0;return b},u=function(a){return document.getElementById(a)},v=function(a){console.log(a)},x=function(a,c){var b=[];w(a.split(/\s+/),function(a){w((c||document).getElementsByTagName(a),function(a){b.push(a)})});return b},w=function(a,c){if(a&&c)if("undefined"!=typeof a[0])for(var b=0,e=a.length;b<e;)c.call(a[b],
a[b],b++);else for(b in a)a.hasOwnProperty&&a.hasOwnProperty(b)&&c.call(a[b],b,a[b])},y=function(a,c){var b=[];w(a||[],function(a,f){b.push(c(a,f))});return b},da=function(a,c){return a.replace(ca,function(a,e){return c[e]||a})},z=function(a,c,b){w(a.split(","),function(a){function f(a){a||(a=window.event);b(a)||(a.cancelBubble=!0,a.returnValue=!1,a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation())}c.addEventListener?c.addEventListener(a,f,!1):c.attachEvent?c.attachEvent("on"+
a,f):c["on"+a]=f})},B=function(){return x("head")[0]},C=function(a,c,b){if(b)a.setAttribute(c,b);else return a&&a.getAttribute&&a.getAttribute(c)},D=function(a,c){for(var b in c)if(c.hasOwnProperty(b))try{a.style[b]=c[b]+(0<"|width|height|top|left|".indexOf(b)&&"number"==typeof c[b]?"px":"")}catch(e){}},F=function(a){return document.createElement(a)},K=function(){return G||J()?0:r()},L=function(a){return y(encodeURIComponent(a).split(""),function(a){return 0>"-_.!~*'()".indexOf(a)?a:"%"+a.charCodeAt(0).toString(16).toUpperCase()}).join("")},
R=function(a){function c(a,b){H||(H=1,a||M(b),h.onerror=j,clearTimeout(I),setTimeout(function(){a&&N();var b=u(i),c=b&&b.parentNode;c&&c.removeChild(b)},O))}if(G||J()){a:{var b,e,f=function(){if(!l){l=1;clearTimeout(q);try{e=JSON.parse(b.responseText)}catch(a){return g(1)}k(e)}},m=0,l=0,q;q=setTimeout(function(){g(1)},P);var E=a.b||n(),k=a.c||n(),g=function(a){m||(m=1,clearTimeout(q),b&&(b.onerror=b.onload=j,b.abort&&b.abort(),b=j),a&&E())};try{b=J()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;
b.onerror=b.onabort=function(){g(1)};b.onload=b.onloadend=f;b.timeout=P;var d=a.url.join(Q);if(a.data){var f=[],s,d=d+"?";for(s in a.data)f.push(s+"="+a.data[s]);d+=f.join(ea)}b.open("GET",d,!0);b.send()}catch(p){g(0);G=0;a=R(a);break a}a=g}return a}var h=F("script"),d=a.a,i=r(),H=0,I=setTimeout(function(){c(1)},P),N=a.b||n(),M=a.c||n();window[d]=function(a){c(0,a)};h[fa]=fa;h.onerror=function(){c(1)};h.src=a.url.join(Q);if(a.data){d=[];h.src+="?";for(key in a.data)d.push(key+"="+a.data[key]);h.src+=
d.join(ea)}C(h,"id",i);B().appendChild(h);return c},T=function(){PUBNUB.time(t);PUBNUB.time(function(){setTimeout(function(){S||(S=1,w(ga,function(a){a[2].subscribe(a[0],a[1])}))},O)})},J=function(){if(!ha.get)return 0;var a={id:J.id++,send:n(),abort:function(){a.id={}},open:function(c,b){J[a.id]=a;ha.get(a.id,b)}};return a};window.console||(window.console=window.console||{});console.log||(console.log=(window.opera||{}).postError||n());var U,V=window.localStorage;U={get:function(a){try{return V?V.getItem(a):
-1==document.cookie.indexOf(a)?j:((document.cookie||"").match(RegExp(a+"=([^;]+)"))||[])[1]||j}catch(c){}},set:function(a,c){try{if(V)return V.setItem(a,c)&&0;document.cookie=a+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(b){}}};var aa=1,ca=/{([\w\-]+)}/g,fa="async",Q="/",ea="&",P=31E4,O=1E3,G=-1==navigator.userAgent.indexOf("MSIE 6"),W,X=Math.floor(9*Math.random())+1;W=function(a){return 0<a.indexOf("pubsub")&&a.replace("pubsub","ps"+(10>++X?X:X=1))||a};var Y={list:{},unbind:function(a){Y.list[a]=
[]},bind:function(a,c){(Y.list[a]=Y.list[a]||[]).push(c)},fire:function(a,c){w(Y.list[a]||[],function(a){a(c)})}},$=u("pubnub")||{},S=0,ga=[],ia=function(a){var c={},b=a.publish_key||"",e=a.subscribe_key||"",f=a.ssl?"s":"",m=a.uuid||U.get(e+"uuid")||"",l="http"+f+"://"+(a.origin||"pubsub.pubnub.com"),q={history:function(a,b){var b=a.callback||b,c=a.limit||100,d=a.channel,f=K();if(!d)return v("Missing Channel");if(!b)return v("Missing Callback");if(!e)return v("Missing Subscribe Key");R({a:f,url:[l,
"history",e,L(d),f,c],c:function(a){b(a)},b:function(a){v(a)}})},detailedHistory:function(a,b){var b=a.callback||b,c=a.count||100,d=a.channel,f=a.reverse||"false",p=a.start,h=a.end,i=K();if(!d)return v("Missing Channel");if(!b)return v("Missing Callback");if(!e)return v("Missing Subscribe Key");var m={};m.count=c;m.reverse=f;p&&(m.start=p);h&&(m.end=h);R({a:i,url:[l,"v2","history","sub-key",e,"channel",L(d)],data:m,c:function(a){b(a)},b:function(a){v(a)}})},time:function(a){var b=K();R({a:b,url:[l,
"time",b],c:function(b){a(b[0])},b:function(){a(0)}})},uuid:function(a){var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});a&&a(b);return b},publish:function(a,c){var c=c||a.callback||n(),g=a.message,d=a.channel,f=K();if(!g)return v("Missing Message");if(!d)return v("Missing Channel");if(!b)return v("Missing Publish Key");if(!e)return v("Missing Subscribe Key");g=JSON.stringify(g);g=[l,"publish",b,e,0,L(d),f,L(g)];
R({a:f,c:function(a){c(a)},b:function(){c([0,"Disconnected"])},url:g,data:{f:m}})},unsubscribe:function(a){function b(a){a in c&&(c[a].d=0,c[a].e&&c[a].e(0))}b(a.channel);b(a.channel+"-pnpres")},subscribe:function(a,b){function g(){var a=K();c[d].d&&(c[d].e=R({a:a,url:[ja,"subscribe",f,L(d),a,h],data:{f:m},b:function(){A||(A=1,N());setTimeout(g,O);q.time(function(a){a&&A?(A=0,I()):i()})},c:function(a){c[d].d&&(Z||(Z=1,H()),A&&(A=0,I()),p=U.set(e+d,h=p&&U.get(f+d)||a[1]),w(a[0],function(c){b(c,a)}),
setTimeout(g,10))}}))}var d=a.channel,b=b||a.callback,f=a.subscribe_key||e,p=a.restore,h=0,i=a.error||n(),H=a.connect||n(),I=a.reconnect||n(),N=a.disconnect||n(),M=a.presence||n(),A=0,Z=0,ja=W(l);if(!S)return ga.push([a,b,q]);if(!d)return v("Missing Channel");if(!b)return v("Missing Callback");if(!e)return v("Missing Subscribe Key");d in c||(c[d]={});if(c[d].d)return v("Already Connected");c[d].d=1;a.presence&&q.i({g:a.channel+"-pnpres",a:M,restore:a.restore});g()},here_now:function(a,b){var b=a.callback||
b,c=a.channel,d=K(),f=W(l);if(!c)return v("Missing Channel");if(!b)return v("Missing Callback");if(!e)return v("Missing Subscribe Key");data=j;"0"!=d&&(data.callback=d);R({a:d,url:[f,"v2","presence","sub_key",e,"channel",L(c)],data:data,c:function(a){b(a)},b:function(a){v(a)}})},xdr:R,ready:T,db:U,each:w,map:y,css:D,$:u,create:F,bind:z,supplant:da,head:B,search:x,attr:C,now:t,unique:r,events:Y,updater:ba,init:ia};""==m&&(m=q.f());U.set(e+"uuid",m);return q};PUBNUB=ia({publish_key:C($,"pub-key"),subscribe_key:C($,
"sub-key"),ssl:"on"==C($,"ssl"),origin:C($,"origin"),uuid:C($,"uuid")});D($,{position:"absolute",top:-O});if("opera"in window||C($,"flash"))$.innerHTML="<object id=pubnubs data=https://dh15atwfs066y.cloudfront.net/pubnub.swf><param name=movie value=https://dh15atwfs066y.cloudfront.net/pubnub.swf><param name=allowscriptaccess value=always></object>";var ha=u("pubnubs")||{};z("load",window,function(){setTimeout(T,0)});PUBNUB.rdx=function(a,c){if(!c)return J[a].onerror();J[a].responseText=unescape(c);
J[a].onload()};J.id=O;window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.h=PUBNUB)&&T()};
})();
